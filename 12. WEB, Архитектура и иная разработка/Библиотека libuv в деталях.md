# Библиотека libuv в деталях

Работа с ядром системы в NodeJS происходит при помощи сторонней библиотеки `libuv`, написанной на `C`.

`libuv` предоставляет Event Loop для NodeJS, а также возможности для работы с сетью (network I/O), файлами (File I/O), операционной системой (Operating System) и другими вещами. 

`libuv` имеет фиксированное количество потоков (по умолчанию 4), вместе называемых `thread pool`. NodeJS отправляет `libuv` очередь задач, откуда потоки из `thread pool` берут (pull) задачи и исполняют их. Когда какой-то поток завершает задачу, он информирует об этом NodeJS и колбэк выполненной задачи поступает в очередь на исполнение.

Когда это возможно, `libuv` избегает использования `thread pool` в пользу использования асинхронных интерфейсов, предоставляемых операционными системами и базами данных.`thead pool` используется лишь в том случае, если такие интерфейсы отсутствуют (или отсутствовали на момент написания библиотеки). На данный момент `thread pool` используется только при работе с файлами (File I/O, модуль `fs`). При работе с сетью (Network I/O, модуль `net` для TCP и IPC, модуль `dgram` для UDP) `thread pool` не используется.

Event Loop однопоточен.

<!-- Reactor pattern. -->

Работа с сетью: TCP и UDP обработчики. Операционная система (Thread pool не используется).
Работа с файлами: stream и pipe в fs (потоки ввода-вывода). Thread pool (работает только с file I/O).

