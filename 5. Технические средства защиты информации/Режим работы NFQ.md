NFQ IPS режим работает следующим образом:

1. Пакет попадает в `iptables`
2. Правило `iptables` направляет его в очередь `NFQUEUE`.
3. Из очереди `NFQUEUE` пакеты могут обрабатываться на уровне пользователя, что и делает Suricata.
4. Suricata прогоняет пакеты по настроенным правилам (`rules`) и в зависимости от них может вынести один из трех вердиктов:
    - `NF_ACCEPT`
    - `NF_DROP`
    - `NF_REPEAT`.
5. Пакеты, попадающие в `NF_REPEAT`, могут быть промаркированы в системе и направлены обратно в начало текущей таблицы `iptables`, что дает огромный потенциал для влияния на дальнейшую судьбу пакетов с помощью правил `iptable`.