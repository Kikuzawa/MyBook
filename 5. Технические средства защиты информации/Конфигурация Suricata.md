Основной конфигурационный файл: `/etc/suricata/suricata.yaml`

### Suricata в режиме IPS

```YAML
nfq:
mode: repeat
```

### Настройка маски для обработанных пакетов:

```YAML
repeat-mark: 1
repeat-mask: 1
default-rule-path: /etc/suricata
rule-files:
    - test.rules
```

### Правила

Создадим правило, которое реагирует на текст TEST

Для этого необходимо создать файл `/etc/suricata/test.rules` и записать в него

```
# Действие Протокол Источник Порт -> Назначение Порт

drop tcp any any -> any any (content: "TEST"; msg: "TEST was drop!";)

```

#### 1. Действие

- `alert` — создать оповещение;
- `pass` — остановить дальнейшую проверку пакета;
- `drop` — отбросить пакет и сгенерировать оповещение;
- `reject` — отправить ошибку недоступности RST/ICMP отправителю соответствующего пакета;
- `ignoresrc` — то же самое, что и reject;
- `ignoredst` — отправить пакет ошибок RST/ICMP получателю соответствующего пакета;
- `ignoreboth` — отправить пакеты ошибок RST/ICMP обеим сторонам соединения.

#### 2. Протокол

- tcp (for tcp-traffic),
- udp,
- icmp,
- ip (ip stands for ‘all’ or ‘any’).
- Существует также несколько протоколов 7 уровня, из которых вы можете выбрать.М

#### 3. Источник и пункт назначения

IP-адреса (поддерживаются как IPv4, так и IPv6) и диапазоны IP-адресов

#### 4. Порты (источник и пункт назначения)

Трафик приходит и уходит через порты

#### 5. Направление.

```
source -> destination
source <> destination (в обе стороны)
```

#### 6. Параметры правила

- Остальная часть правила состоит из опций
- Они заключаются в круглые скобки и разделяются точкой с запятой
- Параметры могут иметь настройки (например, msg), которые задаются ключевым словом параметра, за которым следует двоеточие и параметры.

Общий формат параметров:

```
Без настроке:
<keyword>;

С настройками:
<keyword>: <settings>;
```
