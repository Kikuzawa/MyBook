**iptables** — утилита командной строки, для управления работой межсетевого экрана netfilter

# 5 типов стандартных цепочек, встроенных в систему


1. **PREROUTING**<br>для изначальной обработки входящих пакетов.\
2. **INPUT**<br>для входящих пакетов адресованных непосредственно локальному процессу (клиенту или серверу).
3. **FORWARD**<br>для входящих пакетов перенаправленных на выход.
4. **OUTPUT**<br>для пакетов генерируемых локальными процессами.
5. **POSTROUTING**<br>для окончательной обработки исходящих пакетов.

# Цепочки организованы в 4 таблицы

1. **raw**<br>просматривается до передачи пакета системе определения состояний.
1. **mangle**<br>содержит правила модификации (обычно заголовка) IP‐пакетов.
1. **nat**<br>просматривает только пакеты, создающие новое соединение (согласно системе определения состояний).
1. **filter**<br>основная таблица, используется по умолчанию если название таблицы не указано. Содержит цепочки INPUT, FORWARD, и OUTPUT.


ACCEPT - разрешить прохождение пакета дальше по цепочке правил.
DROP - удалить пакет.
REJECT - отклонить пакет, и сообщить отправителю, что пакет был отклонен
LOG - сделать запись о пакете в лог файл. 
QUEUE - отправить пакет пользовательскому приложению.

![[Pasted image 20241006104357.png]]

# Блокировка IP-адреса

Чтобы заблокировать весь трафик от определенного IP-адреса, вы можете использовать следующую команду:

```
iptables -A INPUT -s 192.168.0.100 -j DROP
```

# Атрибуты
-A - добавить правило в цепочку;
-С - проверить все правила;
-D - удалить правило;
-I - вставить правило с нужным номером;
-L - вывести все правила в текущей цепочке; 
-S - вывести все правила; 
-F - очистить все правила; 
-N - создать цепочку; 
-X - удалить цепочку; 
-P - установить действие по умолчанию. 
-p - указать протокол, один из tcp, udp, udplite, icmp, icmpv6,esp, ah, sctp, mh;
-s - указать ip адрес устройства-отправителя пакета;
-d - указать ip адрес получателя; 
-i - входной сетевой интерфейс; 
-o - исходящий сетевой интерфейс; 
-j - выбрать действие, если правило подошло.


[[netfilter]]
