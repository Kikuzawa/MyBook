алгоритм ориентируется на количество блоков в дереве, образуемом текущей цепочкой.

Учитывается не только длина самой цепочки, но и блоки на разных ее высотах, т. е. в расчете показателей каждой цепочки фактически участвует дерево и количество блоков, которое в нем находится

